{"version":3,"file":"ng-dialog-animation.js","sources":["ng:/ng-dialog-animation/lib/ng-dialog-animation.service.ts"],"names":[],"mappings":"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","sourcesContent":["import { Inject, Injectable, NgZone, Optional, TemplateRef } from '@angular/core';\r\nimport { DialogPosition, MatDialog, MatDialogConfig as _MatDialogConfig, MatDialogRef } from '@angular/material/dialog';\r\nimport { ComponentType } from '@angular/cdk/portal';\r\nimport { Subject } from 'rxjs';\r\n\r\nconst diractionMap = { left: 'left', right: 'left', top: 'top', bottom: 'top' };\r\nconst multyMap = { left: 1, right: -1, top: 1, bottom: -1 };\r\n\r\nexport interface AnimationOption {\r\n    keyframes?: Keyframe[];\r\n    keyframeAnimationOptions: KeyframeAnimationOptions;\r\n}\r\n\r\nexport interface MatDialogConfig extends _MatDialogConfig {\r\n    title?: string;\r\n    animation?:\r\n        | {\r\n              to: 'aside' | 'top' | 'bottom' | 'left' | 'right';\r\n              incomingOptions?: { keyframes?: Keyframe[]; keyframeAnimationOptions: KeyframeAnimationOptions };\r\n              outgoingOptions?: { keyframes?: Keyframe[]; keyframeAnimationOptions: KeyframeAnimationOptions };\r\n          }\r\n        | {\r\n              to?: 'aside' | 'top' | 'bottom' | 'left' | 'right';\r\n              incomingOptions?: { keyframes: Keyframe[]; keyframeAnimationOptions: KeyframeAnimationOptions };\r\n              outgoingOptions?: { keyframes: Keyframe[]; keyframeAnimationOptions: KeyframeAnimationOptions };\r\n          };\r\n    position?: DialogPosition & { rowStart?: string; rowEnd?: string };\r\n}\r\n\r\n@Injectable({\r\n    providedIn: 'root',\r\n})\r\nexport class NgDialogAnimationService {\r\n    constructor(\r\n        private dialog: MatDialog,\r\n        private ngZone: NgZone,\r\n        @Optional()\r\n        @Inject('INCOMING_OPTION')\r\n        private incomingOptions?: AnimationOption,\r\n        @Optional()\r\n        @Inject('OUTGOING_OPTION')\r\n        private outgoingOptions?: AnimationOption,\r\n    ) {}\r\n\r\n    open<T, D = any, R = any>(\r\n        componentOrTemplateRef: ComponentType<T> | TemplateRef<T>,\r\n        config?: MatDialogConfig,\r\n    ): MatDialogRef<T, R> {\r\n        const dir: 'ltr' | 'rtl' =\r\n            config.direction || (document.querySelectorAll('[dir=\"rtl\"]').length ? 'rtl' : 'ltr');\r\n        config.direction = config.direction || dir;\r\n        if (config.animation) {\r\n            if (config.animation.to === 'aside') {\r\n                config.animation.to = dir === 'rtl' ? 'left' : 'right';\r\n            }\r\n        }\r\n\r\n        if (config.position && config.position.rowEnd) {\r\n          if (dir === 'rtl') {\r\n            config.position.right = config.position.rowEnd;\r\n          } else {\r\n            config.position.left = config.position.rowEnd;\r\n          }\r\n        }\r\n\r\n        if (config.position && config.position.rowStart) {\r\n          if (dir === 'rtl') {\r\n            config.position.left = config.position.rowStart;\r\n          } else {\r\n            config.position.right = config.position.rowStart;\r\n          }\r\n        }\r\n\r\n        const ref = this.dialog.open(componentOrTemplateRef, config);\r\n        const container = document.getElementsByTagName('mat-dialog-container')[0] as HTMLElement;\r\n        if (config.title) {\r\n            const el = document.createElement('span');\r\n            el.textContent = config.title;\r\n            el.className = 'dialogTitle';\r\n\r\n            const elClose = document.createElement('span');\r\n            elClose.textContent = 'X';\r\n            elClose.className = 'dialogClose';\r\n            elClose.addEventListener('click', () => {\r\n                ref.close();\r\n            });\r\n\r\n            const titleContainer = document.createElement('div');\r\n            titleContainer.className = 'titleContainer';\r\n            titleContainer.append(el);\r\n            titleContainer.append(elClose);\r\n            container.prepend(titleContainer);\r\n        }\r\n\r\n        if (config.animation) {\r\n            const incomingOptions: AnimationOption = config.animation.incomingOptions ||\r\n                this.incomingOptions || { keyframeAnimationOptions: { duration: 600, easing: 'ease-in' } };\r\n\r\n            const outgoingOptions: AnimationOption = config.animation.outgoingOptions ||\r\n                this.outgoingOptions || { keyframeAnimationOptions: { duration: 600, easing: 'ease-out' } };\r\n\r\n            const wrapper = document.getElementsByClassName('cdk-global-overlay-wrapper')[0];\r\n\r\n            const animate = (keyframes, options) => {\r\n                return wrapper.animate(keyframes, options);\r\n            };\r\n            const _afterClosed = new Subject();\r\n            ref.afterClosed = () => {\r\n                return _afterClosed.asObservable();\r\n            };\r\n            const closeFunction = ref.close;\r\n\r\n            let incomeKeyFrames = incomingOptions.keyframes;\r\n            let outgoingKeyFrames = outgoingOptions.keyframes;\r\n            if (config.animation.to) {\r\n                const to = diractionMap[config.animation.to];\r\n                const keyFrame100 = {};\r\n                const keyFrame0 = {};\r\n                keyFrame0[to] = 0;\r\n                keyFrame100[to] =\r\n                    to === 'top' || to === 'bottom'\r\n                        ? container.clientHeight * multyMap[config.animation.to] + 'px'\r\n                        : container.clientWidth * multyMap[config.animation.to] + 'px';\r\n                incomeKeyFrames = incomeKeyFrames || [keyFrame100, keyFrame0];\r\n                outgoingKeyFrames = outgoingKeyFrames || [keyFrame0, keyFrame100];\r\n            }\r\n            animate(incomeKeyFrames, incomingOptions.keyframeAnimationOptions);\r\n            const closeHandler = (dialogResult?: R) => {\r\n                _afterClosed.next(dialogResult);\r\n                const animation = animate(outgoingKeyFrames, outgoingOptions.keyframeAnimationOptions);\r\n                animation.onfinish = () => {\r\n                    (wrapper as HTMLElement).style.display = 'none';\r\n                    this.ngZone.run(() => ref.close(dialogResult));\r\n                };\r\n                ref.close = closeFunction;\r\n            };\r\n            ref.close = (dialogResult?: R) => closeHandler(dialogResult);\r\n        }\r\n\r\n        return ref;\r\n    }\r\n}\r\n"]}